
---
title: "PADP8120 Midterm Fall 2015"
author: "Thomas K. Valentine"
date: "October 14, 2015"
output:
  html_document:
    highlight: tango 
    theme: united
    
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
---
***
# Data Source

We will analyze data from a New York City school voucher experiment (obtained by Dr. Tyler Scott and a colleague) from Mathematica.

```{r eval=TRUE}
nyc = read.csv('input/NYC_SchoolVoucher_Experiment.csv',row.names=1)
```

***

# Variable Key
| Variable | Description |
|:---|:---|
| `Student_ID` | numerical code for each student |
| `Family_ID` | numerical code for each family |
| `Date.Of.Birth` | student birthday |
| `Female` | binary indicator for female students |
| `Grade`   |  student grade level when starting experiment |
| `Treatment`    |  binary indicator for whether student received voucher |
| `Latino`  |   binary indicator for Latino students |
| `Black` |   binary indicator for black students |
| `Eldest` |   binary indicator for eldest children |
| `y0_read_percentile`   |  pre-test reading score percentile |
| `y0_math_percentile`    |  pre-test math score percentile |
| `y1_read_percentile`   |  reading score percentile after 1y |
| `y1_math_percentile`    |  math score percentile after 1y |
| `y2_read_percentile`   |  reading score percentile after 2y |
| `y2_math_percentile`    |  math score percentile after 2y |
| `y3_read_percentile`   |  reading score percentile after 3y |
| `y3_math_percentile`    |  math score percentile after 3y |

***
#Problems

###1. (6 points) Compute the average reading and math percentiles for each year across all students. 

Using In-Line R Code, we can demonstrate the following values from our "nyc" data set:

####Year 0
1. Average Reading % (across all students) is  <span style="color:green">_`r round(mean(nyc$y0_read_percentile,na.rm=T),2)`_</span>
2. Average Math % (across all students) is  <span style="color:green">_`r round(mean(nyc$y0_math_percentile,na.rm=T),2)`_</span>

####Year 1
1. Average Reading % (across all students) is  <span style="color:green">_`r round(mean(nyc$y1_read_percentile,na.rm=T),2)`_</span>
2. Average Math % (across all students): is  <span style="color:green">_`r round(mean(nyc$y1_math_percentile,na.rm=T),2)`0_</span>

####Year 2
1. Average Reading % (across all students) is  <span style="color:green">_`r round(mean(nyc$y2_read_percentile,na.rm=T),2)`_</span>
2. Average Math % (across all students) is  <span style="color:green">_`r round(mean(nyc$y2_math_percentile,na.rm=T),2)`_</span>

####Year 3
1. Average Reading % (across all students) is  <span style="color:green">_`r round(mean(nyc$y3_read_percentile,na.rm=T),2)`_</span>
2. Average Math % (across all students) is  <span style="color:green">_`r round(mean(nyc$y3_math_percentile,na.rm=T),2)`0_</span>

####Analysis:
*Reading: Increased significantly from year 0-1, then remained mostly unchanged from year 1-2, then increased again from year 2 to 3

*Math: Followed a very similar trend to math. Large increase from 0-1, stable from 1-2, increase from 2-3.

***
###2. (4 points) Clean the original dataset by removing all students who do not have observe pre-test scores and year 1 scores for reading and for math.

```{r}
#We will create a new "clean" data set. To do so, we will create a subset of the original data set "nyc", where any observations contain blank ("NA") reading or math scores in Year Zero or Year 1.
nyc_clean <- subset(nyc, y0_read_percentile != "NA" & y0_math_percentile != "NA" & y1_read_percentile != "NA" & y0_read_percentile != "NA")

#Let's compare the dimensions of our original to our new data set
dim(nyc)
dim(nyc_clean)
```

Our new data set, nyc_clean, kept the 17 variables from the original data set, but lost 1211 observations during this process. We were able to confirm visually (from inside R Studio) that the cleaning process successfully removed observations with missing scores in the correct columns/variables.

***
###3. (8 points) Make a figure (either a density plot or a histogram format) comparing the distributions of percentile reading scores for students who did and did not receive a voucher. Do your best to make the figure "publishable" by giving it clear axis titles, legend labels, and other aesthetic improvements. 

```{r echo=FALSE}
library(dplyr)

```



***
###4. (4 points) In no more than 2-3 sentences, describe what your visualization in 1.C indicates about these data. Do the treatment and control groups appear to be similar (in terms of reading pre-test scores)? Why or why not? 


***
###5. (4 points) Typically, policy experiments such as the NYC school voucher lottery experiment are indended to produce statistical evidence that can then be generalized to broader policy applications (i.e., how might vouchers influence educational outcomes for other students who weren't part of the original experiment). Based on the reading pre-test scores that you visualized in C, describe any concerns you might have about our ability to generalize the results of this experiment to ALL elementary school students in the United States in no more than 2-3 sentences. 

```{r}
summary(cars)
```

***
###6. (4 points) What is the probability that a randomly selected student in the dataset received a voucher and scored above the 50th percentile on the math pre-test?

```{r}
summary(cars)
```

***
###7. (4 points) What is the probability that a randomly selected student who received a voucher group scored above the 50th percentile on the math pre-test?

```{r}
summary(cars)
```

***
###8. (4 points) We are interested in studying whether the change in math scores after one year is different for students who receive a voucher versus those who do not. Write the null and alternative hypotheses in words and then using symbols.

```{r}
summary(cars)
```

***
###9. (6 points) Evaluate the hypothesis from 1.H at a significance level of $\alpha = 0.05$ and state your conclusion in 1-2 sentences. 

```{r}
summary(cars)
```

***
###10. (2 points) Would your conclusion change at $\alpha = 0.10$? Why or why not?

```{r}
summary(cars)
```

***
###11. (6 points) There are four assumptions that hold for the test above to be valid: independence within groups, independence between groups, sample sizes both above 30, and symmetric distributions. Are you satisfied that each of these are upheld? Is there anything in particular that you might be concerned about? 

```{r}
summary(cars)
```

***
###12. (4 points) Next, you are asked to evaluate whether students in the treatment group differ in terms of their reading ability from the pre-test to the year 1 post-test. Write out the null and alternative hypotheses in words and then in symbols. 

```{r}
summary(cars)
```

***
###13. (6 points) Conduct a t-test to evaluate this hypothesis at $\alpha = 0.01$ significance level. Interpret your results in 1-2 complete sentences.  
 
```{r}
summary(cars)
``` 
 
*** 
###14. (4 points) Explain how you could evaluate the hypothesis above using a confidence interval instead of a p-value.

```{r}
summary(cars)
```

***
###15. (2 points) Interpret the confidence interval you estimated for question N in a sentence.

```{r}
summary(cars)
```

***
###16. (8 points) Perform a test of whether the average math pre-test score differs by grade level at $\alpha = 0.10$ significance level. Write out your hypothesis in symbols, perform the test, and then report your findings in a complete sentence.

```{r}
summary(cars)
```

***
###17. (8 points) The NYC School District considers students who perform at or above the 50th percentile to be "passing". At a 99% significance level, is the proportion of all students in the sample (voucher and no-voucher) that are considered to be passing in math significantly different between the pre-test and year 1 post-test?

```{r}
summary(cars)
```

***
###18. (6 points) Make a boxplot that compares the distribution of math scores between the pre-test and year 1 post-test for all students. Do your best to make the figure "publishable" by giving it clear axis titles, legend labels, and other aesthetic improvements. In no more than 2-3 sentences, describe how your figure supports (or does not support) your finding from question 17.

```{r}
summary(cars)
```

***
###19. (4 points) Consider the correlation between math percentile and reading percentile for year 1 test scores. Compute Pearson’s `r` between these two variables. Is the correlation higher or lower than you would have expected? 

```{r}
summary(cars)
```

***
###20. (6 points) You might argue that percentiles are actually rank-order data and not ratio-level data. For rank-order data, a more appropriate correlation measure is Spearman’s $\rho$, which is a rank correlation. Compute $\rho$ and contrast the results from $r$ (for question S above). Why do the results differ?

```{r}
summary(cars)
```

***
#### The command below is for debugging and was adopted from our homework keys

```{r echo=FALSE}
sessionInfo()
```